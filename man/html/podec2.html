  <pre>
      SUBROUTINE <a href=podec2_man.html>PODEC2</a>                                                           
     1(   F          ,R          ,U          )                                                                
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)                                                                     
      PARAMETER                                                                                               
     1(   NDIM=2     )                                                                                        
C Arguments                                                                                                   
      DIMENSION                                                                                               
     1    F(NDIM,NDIM)       ,R(NDIM,NDIM)       ,U(NDIM,NDIM)                                                
C Local variables and arrays                                                                                  
      LOGICAL DUMMY                                                                                           
      DIMENSION                                                                                               
     1    C(NDIM,NDIM)       ,CVEC(4)            ,EIGPRJ(4,NDIM)     ,                                        
     2    EIGC(NDIM)         ,UM1(NDIM,NDIM)     ,UM1VEC(3)          ,                                        
     3    UVEC(3)                                                                                             
      DATA                                                                                                    
     1    R1   /                                                                                              
     2    1.0D0/                                                                                              
C***********************************************************************                                      
C PERFORMS THE RIGHT POLAR DECOMPOSITION OF A 2-D TENSOR                                                      
C                                                                                                             
C REFERENCE: Section 2.2.9                                                                                    
C***********************************************************************                                      
C                T                                                                                            
C Compute  C := F  F                                                                                          
C -------------------                                                                                         
      CALL <a href=rvzero.html>RVZERO</a>(C,NDIM*NDIM)                                                        
      DO 30 I=1,NDIM                                                                                          
        DO 20 J=1,NDIM                                                                                        
          DO 10 K=1,NDIM                                                                                      
            C(I,J)=C(I,J)+F(K,I)*F(K,J)                                                                       
   10     CONTINUE                                                                                            
   20   CONTINUE                                                                                              
   30 CONTINUE                                                                                                
C Perform spectral decomposition of C                                                                         
C -----------------------------------                                                                         
      CVEC(1)=C(1,1)                                                                                          
      CVEC(2)=C(2,2)                                                                                          
      CVEC(3)=C(1,2)                                                                                          
      CALL <a href=spdec2.html>SPDEC2</a>(EIGPRJ     ,EIGC       ,DUMMY      ,CVEC       )                    
C                                                                                                             
C                 1/2         -1                                                                              
C Compute  U := (C)    and   U                                                                                
C ------------------------------                                                                              
C assemble in vector form                                                                                     
      CALL <a href=rvzero.html>RVZERO</a>(UVEC,3)                                                             
      CALL <a href=rvzero.html>RVZERO</a>(UM1VEC,3)                                                           
      DO 50 IDIM=1,NDIM                                                                                       
        UEIG=SQRT(EIGC(IDIM))                                                                                 
        UM1EIG=R1/UEIG                                                                                        
        DO 40 ICOMP=1,3                                                                                       
          UVEC(ICOMP)=UVEC(ICOMP)+UEIG*EIGPRJ(ICOMP,IDIM)                                                     
          UM1VEC(ICOMP)=UM1VEC(ICOMP)+UM1EIG*EIGPRJ(ICOMP,IDIM)                                               
   40   CONTINUE                                                                                              
   50 CONTINUE                                                                                                
C and matrix form                                                                                             
      U(1,1)=UVEC(1)                                                                                          
      U(2,2)=UVEC(2)                                                                                          
      U(1,2)=UVEC(3)                                                                                          
      U(2,1)=UVEC(3)                                                                                          
      UM1(1,1)=UM1VEC(1)                                                                                      
      UM1(2,2)=UM1VEC(2)                                                                                      
      UM1(1,2)=UM1VEC(3)                                                                                      
      UM1(2,1)=UM1VEC(3)                                                                                      
C                           -1                                                                                
C Compute rotation  R := F U                                                                                  
C ----------------------------                                                                                
      CALL <a href=rvzero.html>RVZERO</a>(R,NDIM*NDIM)                                                        
      DO 80 I=1,NDIM                                                                                          
        DO 70 J=1,NDIM                                                                                        
          DO 60 K=1,NDIM                                                                                      
            R(I,J)=R(I,J)+F(I,K)*UM1(K,J)                                                                     
   60     CONTINUE                                                                                            
   70   CONTINUE                                                                                              
   80 CONTINUE                                                                                                
C                                                                                                             
      RETURN                                                                                                  
      END                                                                                                     
 </pre>                                                                                                       
